# **Cyber Genesis - Day 14: Memory Forensics and Malware Analysis** ðŸ§ ðŸ’»

Welcome to **Day 14 of the Cyber Genesis series!** ðŸš€  
Today, we dive into **Memory Forensics and Malware Analysis**, two critical components of digital forensics that focus on investigating volatile data (RAM) and analyzing malicious software to uncover security incidents.

---

## **What is Memory Forensics?**

**Memory Forensics** involves analyzing volatile data captured from a system's memory (RAM) to identify malicious activities, hidden processes, or unencrypted credentials.  

### **Why Memory Forensics is Important:**
1. **Volatile Evidence**  
   - Memory contains ephemeral data like running processes, open network connections, and encryption keys.  

2. **Rootkit and Malware Detection**  
   - Malicious programs often hide in memory to avoid detection by traditional file-based methods.  

3. **Incident Reconstruction**  
   - Analyzing memory helps reconstruct events leading up to a security breach.  

---

## **What is Malware Analysis?**

**Malware Analysis** is the process of dissecting malicious software to understand its behavior, identify Indicators of Compromise (IoCs), and develop mitigation strategies.

### **Types of Malware Analysis:**
1. **Static Analysis**  
   - Examines the file without executing it, analyzing strings, file headers, and metadata.  

2. **Dynamic Analysis**  
   - Executes the malware in a controlled environment to observe its runtime behavior.  

3. **Code Analysis**  
   - Involves reverse engineering the malware to study its source code.  

---

## **Tools for Memory Forensics**

### **1. Volatility Framework**  
**Description**: A powerful open-source tool for analyzing memory dumps.  
- **Features**:  
  - Identify running processes, DLLs, and hidden processes.  
  - Detect network connections and loaded drivers.  
  - Extract unencrypted credentials.  

**Example Command**:  
```bash
volatility -f memory_dump.raw --profile=Win10x64_19041 pslist
```
- `pslist`: Lists all running processes.  

---

### **2. DumpIt**  
**Description**: A lightweight tool for creating memory dumps.  
- **Usage**: Run DumpIt on the target machine to capture a snapshot of the system's RAM.  

---

### **3. Rekall Framework**  
**Description**: A memory forensics tool designed for live analysis.  
- **Features**: Similar to Volatility but optimized for speed and live investigations.  

---

### **4. Redline**  
**Description**: A user-friendly tool for collecting and analyzing memory and file system activity.  
- **Features**:  
  - Process analysis and memory artifact detection.  
  - Focused investigations with guided workflows.  

---

## **Tools for Malware Analysis**

### **1. Strings (Command-Line Tool)**  
**Description**: Extract readable text from binary files to reveal IoCs or hidden commands.  
**Command Example**:  
```bash
strings malware.exe
```

---

### **2. IDA Pro**  
**Description**: An advanced disassembler for reverse engineering malware.  
- **Usage**: Study assembly code to understand malware behavior.  

---

### **3. Ghidra**  
**Description**: A free, open-source reverse engineering tool by the NSA.  
- **Features**: Decompiles binaries into human-readable code for analysis.  

---

### **4. Cuckoo Sandbox**  
**Description**: An open-source tool for dynamically analyzing malware in an isolated environment.  
- **Features**:  
  - Observe file modifications, network traffic, and runtime behavior.  

---

## **Memory Forensics Workflow**

### **Step 1: Capture Memory**
- Use tools like **DumpIt** or **FTK Imager** to capture the memory dump of the target system.

### **Step 2: Analyze the Memory Dump**
- Load the memory dump into **Volatility** or **Rekall**.  
- Key Commands:  
  - List processes:  
    ```bash
    volatility -f memory_dump.raw pslist
    ```  
  - Check network connections:  
    ```bash
    volatility -f memory_dump.raw netscan
    ```  

### **Step 3: Extract Artifacts**
- Extract malicious binaries, credentials, or files hidden in memory.

---

## **Malware Analysis Workflow**

### **Static Analysis Steps:**
1. **Inspect File Metadata**  
   - Tools: ExifTool, Strings.  
   - Example:  
     ```bash
     strings malware.exe
     ```  

2. **Check Virus Total**  
   - Upload the file to [VirusTotal](https://www.virustotal.com) for initial analysis.

3. **Decompile with Ghidra or IDA Pro**  
   - Study the assembly or decompiled code to understand malicious logic.

---

### **Dynamic Analysis Steps:**
1. **Execute Malware in a Sandbox**  
   - Use **Cuckoo Sandbox** or **Any.Run** to monitor runtime behavior.  

2. **Monitor Network Traffic**  
   - Tools: Wireshark, Zeek.  
   - Example: Identify Command-and-Control (C2) traffic.  

3. **Observe File System Changes**  
   - Tools: Procmon, Sysinternals Suite.

---

## **Practical Exercise**

### **Scenario**:  
A suspicious process is detected on a Windows machine.  

#### **Steps to Investigate**:
1. **Capture Memory**  
   - Use **DumpIt** to capture a memory dump.  

2. **Analyze the Memory Dump**  
   - Use Volatility to list running processes:  
     ```bash
     volatility -f memory_dump.raw pslist
     ```  
   - Look for suspicious processes with high memory usage or unusual names.

3. **Extract Malware**  
   - Dump the executable from memory using Volatility:  
     ```bash
     volatility -f memory_dump.raw procdump -p <PID> -D /path/to/output
     ```  

4. **Perform Malware Analysis**  
   - Conduct static analysis using **Strings** or **Ghidra**.  
   - Use **Cuckoo Sandbox** for dynamic analysis.

---

## **Key Commands for Volatility**

- **List running processes**:  
  ```bash
  volatility -f memory_dump.raw pslist
  ```  

- **Detect open network connections**:  
  ```bash
  volatility -f memory_dump.raw netscan
  ```  

- **Dump process memory**:  
  ```bash
  volatility -f memory_dump.raw procdump -p <PID> -D /output/path
  ```  

- **Check loaded DLLs**:  
  ```bash
  volatility -f memory_dump.raw dlllist
  ```

---

## **Resources for Day 14**

### **Official Tools and Documentation**  
- [Volatility Framework](https://www.volatilityfoundation.org/)  
- [Ghidra Official Site](https://ghidra-sre.org/)  
- [Cuckoo Sandbox](https://cuckoosandbox.org/)  

### **Interactive Labs**  
- **TryHackMe**: [Volatility Room](https://tryhackme.com/r/room/volatility)
- **TryHackMe**: [Memory Forensics Room](https://tryhackme.com/r/room/memoryforensics)

### **YouTube Tutorials**  
- [Memory Forensics with Volatility](https://youtu.be/Uk3DEgY5Ue8?si=37y2tWxxAumyizKb)  
  
---

## **Ethics and Legal Considerations**

1. **Integrity**: Ensure memory dumps and analysis logs are unaltered.  
2. **Authorization**: Perform memory analysis only on systems you are authorized to investigate.  
3. **Privacy**: Protect sensitive data discovered during analysis.  

---

## **Created by:**

**Raman Mohurle & Varad Mene**

---

## **Contributing**  
Feel free to contribute by suggesting edits, adding more resources, or sharing your learning experiences.
